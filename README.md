# pyoasis

Python interface to CAISO's OASIS API

**Download Reports**
```
In [1]: from pyoasis.utils import create_oasis_url, download_files, get_report_params
   ...: from pyoasis.report import OASISReport
   ...: from datetime import datetime, timedelta
   ...: end = datetime.utcnow()
   ...: start = end - timedelta(days=1)                                                                                                                    

In [2]: get_report_params('PRC_LMP')                                                                                                                       
Out[2]:
{'oasis.caiso.com': {'/oasisapi/SingleZip': {'PRC_LMP': [{'enddatetime': '20130920T07:00-0000',
     'grp_type': 'ALL_APNODES',
     'market_run_id': 'DAM',
     'queryname': 'PRC_LMP',
     'startdatetime': '20130919T07:00- 0000',
     'version': '1'},
    {'enddatetime': '20130920T07:00-0000',
     'market_run_id': 'DAM',
     'node': 'LAPLMG1_7_B2',
     'queryname': 'PRC_LMP',
     'startdatetime': '20130919T07:00- 0000',
     'version': '1'}]}}}

In [3]: url = create_oasis_url(report_name='PRC_LMP', start=start, end=end, query_params={'grp_type': 'ALL_APNODES', 'market_run_id': 'DAM', 'version': 1})

In [4]: url
Out[4]: 'http://oasis.caiso.com/oasisapi/SingleZip?grp_type=ALL_APNODES&market_run_id=DAM&version=1&startdatetime=20181129T18:05-0800&enddatetime=20181130T18:05-0800&queryname=PRC_LMP'

In [5]: download_files(url, 'downloads')
Out[5]: ['~/downloads/20181129_20181129_PRC_LMP_DAM_20181130_10_06_32_v1.xml']
```

**Parse Reports**
```
In [1]: from pyoasis.report import OASISReport                                                                                                             

In [2]: oasis_report = OASISReport('downloads/20181129_20181129_PRC_LMP_DAM_20181130_10_06_32_v1.xml')                                                     

In [3]: oasis_report.report_dataframe                                                                                                                      
Out[3]:
           DATA_ITEM        RESOURCE_NAME    OPR_DATE INTERVAL_NUM         INTERVAL_START_GMT           INTERVAL_END_GMT     VALUE
0            LMP_PRC  AFPR_1_TOT_GEN-APND  2018-11-29           20  2018-11-30T03:00:00-00:00  2018-11-30T04:00:00-00:00   73.0991
1            LMP_PRC  AFPR_1_TOT_GEN-APND  2018-11-29           24  2018-11-30T07:00:00-00:00  2018-11-30T08:00:00-00:00  56.34853
2            LMP_PRC  AFPR_1_TOT_GEN-APND  2018-11-29           23  2018-11-30T06:00:00-00:00  2018-11-30T07:00:00-00:00  56.55006
3            LMP_PRC  AFPR_1_TOT_GEN-APND  2018-11-29           22  2018-11-30T05:00:00-00:00  2018-11-30T06:00:00-00:00  66.91767
4            LMP_PRC  AFPR_1_TOT_GEN-APND  2018-11-29           21  2018-11-30T04:00:00-00:00  2018-11-30T05:00:00-00:00  68.45518
5       LMP_CONG_PRC  AFPR_1_TOT_GEN-APND  2018-11-29           22  2018-11-30T05:00:00-00:00  2018-11-30T06:00:00-00:00         0
6       LMP_CONG_PRC  AFPR_1_TOT_GEN-APND  2018-11-29           24  2018-11-30T07:00:00-00:00  2018-11-30T08:00:00-00:00         0
7       LMP_CONG_PRC  AFPR_1_TOT_GEN-APND  2018-11-29           20  2018-11-30T03:00:00-00:00  2018-11-30T04:00:00-00:00         0
8       LMP_CONG_PRC  AFPR_1_TOT_GEN-APND  2018-11-29           23  2018-11-30T06:00:00-00:00  2018-11-30T07:00:00-00:00  -1.96456
9       LMP_CONG_PRC  AFPR_1_TOT_GEN-APND  2018-11-29           21  2018-11-30T04:00:00-00:00  2018-11-30T05:00:00-00:00  -1.55442
10       LMP_ENE_PRC  AFPR_1_TOT_GEN-APND  2018-11-29           23  2018-11-30T06:00:00-00:00  2018-11-30T07:00:00-00:00  60.13217
11       LMP_ENE_PRC  AFPR_1_TOT_GEN-APND  2018-11-29           20  2018-11-30T03:00:00-00:00  2018-11-30T04:00:00-00:00  76.23225
12       LMP_ENE_PRC  AFPR_1_TOT_GEN-APND  2018-11-29           24  2018-11-30T07:00:00-00:00  2018-11-30T08:00:00-00:00  57.72823
13       LMP_ENE_PRC  AFPR_1_TOT_GEN-APND  2018-11-29           21  2018-11-30T04:00:00-00:00  2018-11-30T05:00:00-00:00  72.86595
14       LMP_ENE_PRC  AFPR_1_TOT_GEN-APND  2018-11-29           22  2018-11-30T05:00:00-00:00  2018-11-30T06:00:00-00:00  69.26578
15      LMP_LOSS_PRC  AFPR_1_TOT_GEN-APND  2018-11-29           20  2018-11-30T03:00:00-00:00  2018-11-30T04:00:00-00:00  -3.13315
16      LMP_LOSS_PRC  AFPR_1_TOT_GEN-APND  2018-11-29           24  2018-11-30T07:00:00-00:00  2018-11-30T08:00:00-00:00   -1.3797
17      LMP_LOSS_PRC  AFPR_1_TOT_GEN-APND  2018-11-29           22  2018-11-30T05:00:00-00:00  2018-11-30T06:00:00-00:00  -2.34811
18      LMP_LOSS_PRC  AFPR_1_TOT_GEN-APND  2018-11-29           23  2018-11-30T06:00:00-00:00  2018-11-30T07:00:00-00:00  -1.61756
19      LMP_LOSS_PRC  AFPR_1_TOT_GEN-APND  2018-11-29           21  2018-11-30T04:00:00-00:00  2018-11-30T05:00:00-00:00  -2.85635
20           LMP_PRC  AGRICO_6_PL3N5-APND  2018-11-29           22  2018-11-30T05:00:00-00:00  2018-11-30T06:00:00-00:00  73.77499
21           LMP_PRC  AGRICO_6_PL3N5-APND  2018-11-29           20  2018-11-30T03:00:00-00:00  2018-11-30T04:00:00-00:00  76.16869
22           LMP_PRC  AGRICO_6_PL3N5-APND  2018-11-29           21  2018-11-30T04:00:00-00:00  2018-11-30T05:00:00-00:00  72.60185
23           LMP_PRC  AGRICO_6_PL3N5-APND  2018-11-29           23  2018-11-30T06:00:00-00:00  2018-11-30T07:00:00-00:00  63.22898
24           LMP_PRC  AGRICO_6_PL3N5-APND  2018-11-29           24  2018-11-30T07:00:00-00:00  2018-11-30T08:00:00-00:00  60.86287
25      LMP_CONG_PRC  AGRICO_6_PL3N5-APND  2018-11-29           22  2018-11-30T05:00:00-00:00  2018-11-30T06:00:00-00:00         0
26      LMP_CONG_PRC  AGRICO_6_PL3N5-APND  2018-11-29           24  2018-11-30T07:00:00-00:00  2018-11-30T08:00:00-00:00         0
27      LMP_CONG_PRC  AGRICO_6_PL3N5-APND  2018-11-29           20  2018-11-30T03:00:00-00:00  2018-11-30T04:00:00-00:00  -3.44065
28      LMP_CONG_PRC  AGRICO_6_PL3N5-APND  2018-11-29           23  2018-11-30T06:00:00-00:00  2018-11-30T07:00:00-00:00         0
29      LMP_CONG_PRC  AGRICO_6_PL3N5-APND  2018-11-29           21  2018-11-30T04:00:00-00:00  2018-11-30T05:00:00-00:00  -3.06215
...              ...                  ...         ...          ...                        ...                        ...       ...
156450   LMP_ENE_PRC    YALE_7_UNITS-APND  2018-11-30            5  2018-11-30T12:00:00-00:00  2018-11-30T13:00:00-00:00    53.326
156451   LMP_ENE_PRC    YALE_7_UNITS-APND  2018-11-30           19  2018-12-01T02:00:00-00:00  2018-12-01T03:00:00-00:00  78.25971
156452   LMP_ENE_PRC    YALE_7_UNITS-APND  2018-11-30            1  2018-11-30T08:00:00-00:00  2018-11-30T09:00:00-00:00  53.28205
156453   LMP_ENE_PRC    YALE_7_UNITS-APND  2018-11-30           12  2018-11-30T19:00:00-00:00  2018-11-30T20:00:00-00:00  48.05225
156454   LMP_ENE_PRC    YALE_7_UNITS-APND  2018-11-30           13  2018-11-30T20:00:00-00:00  2018-11-30T21:00:00-00:00  44.77198
156455   LMP_ENE_PRC    YALE_7_UNITS-APND  2018-11-30           15  2018-11-30T22:00:00-00:00  2018-11-30T23:00:00-00:00  47.64879
156456   LMP_ENE_PRC    YALE_7_UNITS-APND  2018-11-30           16  2018-11-30T23:00:00-00:00  2018-12-01T00:00:00-00:00  58.46782
156457   LMP_ENE_PRC    YALE_7_UNITS-APND  2018-11-30           10  2018-11-30T17:00:00-00:00  2018-11-30T18:00:00-00:00   50.5423
156458   LMP_ENE_PRC    YALE_7_UNITS-APND  2018-11-30           18  2018-12-01T01:00:00-00:00  2018-12-01T02:00:00-00:00  85.85304
156459   LMP_ENE_PRC    YALE_7_UNITS-APND  2018-11-30            8  2018-11-30T15:00:00-00:00  2018-11-30T16:00:00-00:00  74.11099
156460   LMP_ENE_PRC    YALE_7_UNITS-APND  2018-11-30            6  2018-11-30T13:00:00-00:00  2018-11-30T14:00:00-00:00  62.41285
156461  LMP_LOSS_PRC    YALE_7_UNITS-APND  2018-11-30           12  2018-11-30T19:00:00-00:00  2018-11-30T20:00:00-00:00   0.07688
156462  LMP_LOSS_PRC    YALE_7_UNITS-APND  2018-11-30            3  2018-11-30T10:00:00-00:00  2018-11-30T11:00:00-00:00  -0.35553
156463  LMP_LOSS_PRC    YALE_7_UNITS-APND  2018-11-30            7  2018-11-30T14:00:00-00:00  2018-11-30T15:00:00-00:00  -1.95882
156464  LMP_LOSS_PRC    YALE_7_UNITS-APND  2018-11-30           11  2018-11-30T18:00:00-00:00  2018-11-30T19:00:00-00:00   0.07913
156465  LMP_LOSS_PRC    YALE_7_UNITS-APND  2018-11-30           14  2018-11-30T21:00:00-00:00  2018-11-30T22:00:00-00:00  -0.23807
156466  LMP_LOSS_PRC    YALE_7_UNITS-APND  2018-11-30           17  2018-12-01T00:00:00-00:00  2018-12-01T01:00:00-00:00   -2.2374
156467  LMP_LOSS_PRC    YALE_7_UNITS-APND  2018-11-30            6  2018-11-30T13:00:00-00:00  2018-11-30T14:00:00-00:00  -0.86754
156468  LMP_LOSS_PRC    YALE_7_UNITS-APND  2018-11-30            5  2018-11-30T12:00:00-00:00  2018-11-30T13:00:00-00:00  -0.53326
156469  LMP_LOSS_PRC    YALE_7_UNITS-APND  2018-11-30           18  2018-12-01T01:00:00-00:00  2018-12-01T02:00:00-00:00  -3.01344
156470  LMP_LOSS_PRC    YALE_7_UNITS-APND  2018-11-30            8  2018-11-30T15:00:00-00:00  2018-11-30T16:00:00-00:00  -1.58598
156471  LMP_LOSS_PRC    YALE_7_UNITS-APND  2018-11-30            1  2018-11-30T08:00:00-00:00  2018-11-30T09:00:00-00:00  -0.35699
156472  LMP_LOSS_PRC    YALE_7_UNITS-APND  2018-11-30           10  2018-11-30T17:00:00-00:00  2018-11-30T18:00:00-00:00  -0.13646
156473  LMP_LOSS_PRC    YALE_7_UNITS-APND  2018-11-30            2  2018-11-30T09:00:00-00:00  2018-11-30T10:00:00-00:00  -0.29487
156474  LMP_LOSS_PRC    YALE_7_UNITS-APND  2018-11-30           19  2018-12-01T02:00:00-00:00  2018-12-01T03:00:00-00:00  -2.88778
156475  LMP_LOSS_PRC    YALE_7_UNITS-APND  2018-11-30           15  2018-11-30T22:00:00-00:00  2018-11-30T23:00:00-00:00  -0.16201
156476  LMP_LOSS_PRC    YALE_7_UNITS-APND  2018-11-30           16  2018-11-30T23:00:00-00:00  2018-12-01T00:00:00-00:00  -0.60222
156477  LMP_LOSS_PRC    YALE_7_UNITS-APND  2018-11-30           13  2018-11-30T20:00:00-00:00  2018-11-30T21:00:00-00:00  -0.30893
156478  LMP_LOSS_PRC    YALE_7_UNITS-APND  2018-11-30            4  2018-11-30T11:00:00-00:00  2018-11-30T12:00:00-00:00  -0.33405
156479  LMP_LOSS_PRC    YALE_7_UNITS-APND  2018-11-30            9  2018-11-30T16:00:00-00:00  2018-11-30T17:00:00-00:00  -0.50732

[156480 rows x 7 columns]
```
